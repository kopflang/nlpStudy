http://cseweb.ucsd.edu/~elkan/250Bfall2007/loglinear.pdf